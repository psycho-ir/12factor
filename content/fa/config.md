## III. پیکربندی یا کانفیگ
### پیکربندی را در Environment نگه دارید

*پیکربندی* یک App هر چیزی است که احتمالا بین [Deploymentهای](./codebase) مختلف متفاوت است.( مثل Staging ، محیط اجرا, محیط توسعه و غیره) که شامل این موارد می‌شود:

* منابع مرتبط با دیتابیس، Memcached و غیر [backing services](./backing-services)
* مجوزهای مربوط به سرویس های خارجی مثل Amazon S3 یا Twitter
* مقادیر Pre-deploy مثل Hostname محل Deploy 

Appها گاهی پیکربندی‌ها را به صورت مقادیر ثابت داخل کد نگه میدارند.این نقض  tweleve-factor  است، و باید **پیکربندی‌ها را کاملا از کد جدا کرد**. اساسا پیکربندی‌ها بین deployment‌های مختلف متفاوت‌اند در حالی که کد همیشه یکسان است.

یک تست litmus برای نشان دادن این که آیا یک app به درستی تمام پیکربندی‌ها را از کد جدا کرده این است که آیا می‌توان در هر لحظه کد را متن‌باز کرد بدون اینکه هیچ مجوزی افشا شود.

دقت کنید که این توضیح در مورد پیکربندی شامل پیکربندی‌های داخلی application **نمی‌شوند**، مثل `config/routes.rb` در پروژه‌های Rails یا [چگونگی اتصال ماژول ها](http://docs.spring.io/spring/docs/current/spring-framework-reference/html/beans.html) در [Spring](http://spring.io/).این نوع از پیکربندی‌ها بین deployهای مختلف متفاوت نیستند، و بهتر است داخل کد قرار بگیرند.

روش دیگر استفاده از فایل‌های پیکربندی یا Config files است که البته داخل revision control نگهداری نمی‌شوند, مثل `config/database.yml` در Rails.
این روش به مراتب بهتر از نگهداری مقادیر ثابتی است که داخل Code repo قرار میگیرند اما هنوز هم این روش ضعف‌هایی دارد: به سادگی ممکن است فایل کانفیگ اشتباها داخل Code repo قرار بگیرد; به مرور ممکن است کل پروژه پر از فایل‌های پیکربندی مختلف در مکان‌های مختلف و با فرمت‌های مختلف شود که در نتیجه مدیریت آن‌ها را سخت می‌کند. به علاوه، این فرمت ها معمولا مختص یک زبان خاص یا فریمورک خاص هستند و با هم متفاوت‌اند.

** app های twelve-factor  پیکربندی را در *environment variable ها* نگه می‌دارند.**(معمولا به طور کوتاه شده *env vars* یا *env* هم گفته می‌شود و ما از واژه متغیر محیطی استفاده می‌کنیم). متغیر‌های محیطی به سادگی بین deployها تغییر میکنند و نیازی به تغییر کد نیست; برخلاف فایل‌های پیکربندی, شانس خیلی کمی است که آنها اتفاقی داخل Code repo قرار بگیرند, و برخلاف فایل‌های پیکربندی دلخواه زبان‌ها و فریمورک‌ها این نوع پیکربندی استانداردی است که همه زبان‌ها و سیستم‌عامل‌ها پشتیبانی می‌کنند.

جنبه‌ی دیگر مدیریت پیکربندی، گروه‌بندی است.گاها appها پیکربندی‌ها را در گروه‌هایی با نام مشخص قرار می‌دهد.(معمولا Environment به آنها اطلاق می‌شود) که این نام‌گذاری بر اساس یک deploy بخصوص است, مثل محیط‌های `development`, `test`, و `اجرا`  در Rails.این روش به خوبی مقیاس‌پذیر نیست: به مرور deploy های مختلف دیگری هم ایجاد می‌شوند مثل `staging` یا `qa` و بعد از مدتی توسعه‌دهنده ها ممکن است پیکربندی‌های خاص خودشان را هم اضافه کنند مثل `Samans-staging`، در نتیجه موجب می‌شود تعداد فایل‌های کانفیگ زیاد شود و در Deployment مشکل ایجاد کنند.


در یک app مطابق با twelve-factor ، متغیر‌های محیطی ابزار کنترلی منعطفی هستند که هر یک به طور کامل با بقیه سازگاری دارد.آن‌ها هرگز با هم تشکیل یک گروه بخصوص برای یک محیط بخصوص را نمی‌دهند، در عوض به صورت مستقل برای هر deploy مدیریت می‌شوند.
این مدل همین‌طور که app به صورت طبیعی بین deploy های متعدد در طول عمر خود بزرگ می‌شود به نرمی مقیاس‌پذیر است.


















